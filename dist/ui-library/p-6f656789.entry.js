import{r as t,c as i,h as s,H as e}from"./p-fe42e5c8.js";import{T as h}from"./p-8e6cf72b.js";const a=class{constructor(s){t(this,s),this.balDatetimeChange=i(this,"balDatetimeChange",7),this.balBlur=i(this,"balBlur",2),this.isPristine=!0,this.placeholder="Click to select...",this.disabled=!1,this.inverted=!1,this.maxDatetime="",this.maxDate="",this.maxTime="",this.currentMaxTime="",this.minDatetime="",this.minDate="",this.minTime="",this.currentMinTime="",this.maxYear="",this.minYear="",this.value="",this.dateFilter=()=>!0}minDatetimeWatcher(t){this.parseMinDatetime(t)}maxDatetimeWatcher(t){this.parseMaxDatetime(t)}valueWatcher(t){this.parseValue(t)}componentWillLoad(){this.minDatetime&&this.parseMinDatetime(this.minDatetime),this.maxDatetime&&this.parseMaxDatetime(this.maxDatetime),this.value&&this.parseValue(this.value)}async open(){await this.datepickerElement.open()}async close(){await this.datepickerElement.close()}parseMinDatetime(t){const i=a.FORMAT.exec(t);if(null!==i)return this.minDate=i[1],this.minTime=i[2],void this.updateCurrenTimeBound();this.minDate="",this.minTime=""}parseMaxDatetime(t){const i=a.FORMAT.exec(t);if(null!==i)return this.maxDate=i[1],this.maxTime=i[2],void this.updateCurrenTimeBound();this.maxDate="",this.maxTime=""}parseValue(t){this.isPristine=!1;const i=a.FORMAT.exec(t);if(null!==i)return this.date=i[1],this.time=i[2],void this.updateCurrenTimeBound();this.date=void 0,this.time=void 0}async selectDate(t){this.date=t.detail,this.updateCurrenTimeBound()}async changeTime(t){this.time=t.detail}save(){this.value=a.formatValue(this.date,this.time),this.balDatetimeChange.emit(this.value),this.datepickerElement.close()}abort(){this.parseValue(this.value),this.datepickerElement.close()}async onBlur(){this.parseValue(this.value),this.balBlur.emit()}updateCurrenTimeBound(){if(this.currentMinTime="00:00",this.currentMaxTime="23:59",this.date===this.minDate&&(this.currentMinTime=this.minTime),this.date===this.maxDate&&(this.currentMaxTime=this.maxTime),void 0!==this.time){const t=this.toSecondCount(this.time),i=this.toSecondCount(this.currentMinTime),s=this.toSecondCount(this.currentMaxTime);this.time=this.toClockString(Math.min(s,Math.max(i,t)))}}toSecondCount(t){const i=h.CLOCK_PATTERN.exec(t);return null===i?0:60*parseInt(i[1],10)+parseInt(i[2],10)}toClockString(t){return h.formatTimeBoxValue(Math.floor(t/60))+":"+h.formatTimeBoxValue(t%60)}formatDatepickerLabel(t){return void 0!==t&&""!==t&&void 0!==this.time?a.formatValue(t,this.time):void 0!==t?t:this.time}static formatValue(t,i){return t+" "+i}canSave(){return void 0!==this.date&&void 0!==this.time}onKeyDown(t){if("Enter"===t.key){if(this.canSave())return void this.save();this.abort()}"ESC"===t.key&&this.abort()}render(){return s(e,null,s("bal-datepicker",{value:this.date,disabled:this.disabled,inverted:this.inverted,placeholder:this.placeholder,maxDate:this.maxDate,minDate:this.minDate,maxYear:this.maxYear,minYear:this.minYear,closeOnSelect:!1,filter:this.dateFilter,formatLabel:this.formatDatepickerLabel.bind(this),onBalChange:this.selectDate.bind(this),onBalBlur:this.onBlur.bind(this),ref:t=>this.datepickerElement=t},s("div",{class:"bal-datetimepicker-panel"},s("bal-button",{disabled:this.disabled,onClick:()=>this.abort(),type:"is-info",size:"is-small","is-square":!0,outlined:!0},s("bal-icon",{name:"close-big",size:"medium"})),s("bal-timeinput",{class:"bal-datetimepicker-timeinput",value:this.time,minTime:this.currentMinTime,maxTime:this.currentMaxTime,disabled:this.disabled,onBalTimeinputChange:this.changeTime.bind(this),ref:t=>this.timeinputElement=t}),s("bal-button",{disabled:this.disabled||!this.canSave(),onClick:()=>this.save(),type:"is-info",size:"is-small","is-square":!0,outlined:!0,ref:t=>this.saveButtonElement=t},s("bal-icon",{name:"check",size:"medium"})))))}static get watchers(){return{minDatetime:["minDatetimeWatcher"],maxDatetime:["maxDatetimeWatcher"],value:["valueWatcher"]}}};a.FORMAT=/^([0-9]{2}.[0-9]{2}.[0-9]{4}) ([0-9]{1,2}:[0-9]{1,2})$/,a.style="*{-webkit-box-sizing:border-box;box-sizing:border-box;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%}:host{display:block;position:relative}.bal-datetimepicker-panel{padding-top:12px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.bal-datetimepicker-panel .bal-datetimepicker-timeinput{-ms-flex-positive:1;flex-grow:1}";export{a as bal_datetimepicker}